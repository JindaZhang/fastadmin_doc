

    <div class="content with-sidebar">
        <h1 data-id="158" data-eid="V4v5">
        常见问题    </h1>
    
    <p>如果你在使用FastAdmin开发框架的过程中遇到问题,请到问答社区提问: <a href="https://ask.fastadmin.net" target="_blank" >https://ask.fastadmin.net</a></p><h3 id="在FastAdmin中如何开启调试模式？-1">在FastAdmin中如何开启调试模式？</h3><p>开启调试模式的方法有两种：</p><ul><li>打开<code>application/config.php</code>，找到<code>app_debug</code>,将它的值置为<code>true</code>即可</li><li>如果你有启用<code>.env</code>环境配置，修改其中<code>app_debug</code>的值为<code>true</code>即可。</li></ul><h3 id="为什么在调试模式下功能正常，但在生产环境下功能失效-2">为什么在调试模式下功能正常，但在生产环境下功能失效</h3><p>如果你有修改了框架核心的JS文件或者修改了核心样式文件，需要使用命令重新压缩打包JS和CSS后才会在生产环境下生效，具体请参考：<a href="https://doc.fastadmin.net/doc/162.html" target="_blank" >https://doc.fastadmin.net/doc/162.html</a></p><h3 id="为什么在外网访问后台速度非常慢-3">为什么在外网访问后台速度非常慢</h3><p>如果你在外网开启了调试模式，因为在调试模式下加载的文件非常多，访问速度会非常慢，请在外网或生产环境下关闭调试模式。如果有更高的响应要求，建议采用CDN部署静态资源。部署方式请参考：<a  href="#toc-23"  target="_blank">#如何将静态资源采用CDN方式部署到第三方云存储</a></p><h3 id="如何启用后台管理多级菜单功能-4">如何启用后台管理多级菜单功能</h3><p>FastAdmin从<code>1.0.0.20180513_beta</code>版本开始新增了多级菜单功能，开发者可以很方便的在配置文件中修改是否开启多级菜单功能，找到<code>application/config.php</code>文件最下方有个<code>multiplenav</code>配置，默认是<code>false</code>，如果需要启用，请将<code>multiplenav</code>置为<code>true</code>即可。</p><p>如果启用了多级菜单后，菜单规则中的第一级将作为一级菜单显示在顶部。我们可以在<code>权限管理</code>-&gt;<code>菜单规则</code>中额外添加一级菜单，然后再重新规划我们的菜单。</p><div class="custom-block github-alert tip"><p class="custom-block-title">温馨提示</p><p>FastAdmin从<code>1.3.0</code>版本开始已经支持后台个性化布局，后台管理员登录后直接在后台管理右上角修改对应的布局后即可实时生效，无需修改配置文件。</p></div><h3 id="插件管理配置了错误的伪静态前台无法访问时如何操作-5">插件管理配置了错误的伪静态前台无法访问时如何操作</h3><p>如果在后台配置某一插件的伪静态错误时，导致前台完全无法打开时，你可以尝试使用<a href="https://www.fastadmin.net/outlink.html?url=http%3A%2F%2Fwww.yoursite.com%2F" target="_blank" rel="nofollow">http://www.yoursite.com/</a>随机字符.php 进行登录后台，登录后再重新配置伪静态即可。<br>如果连后台登录也报错，可以尝试修改<code>application/extra/addons.php</code>，移除键名为<code>route</code>对应的值，修改为<code>[]</code>，然后登录后台修改正确的伪静态，再清除缓存即可。</p><h3 id="如何在生成CRUD时生成回收站功能-6">如何在生成CRUD时生成回收站功能</h3><p>FastAdmin从<code>1.0.0.20190301_beta</code>版本开始已经支持自动生成回收站功能，如果需要生成回收站功能，请确保你的FastAdmin版本，其次确保你的数据表中存在<code>deletetime</code>这个字段，<font  color="blue">默认值必须为null,不能为0</font>，只需保证存在此字段，CRUD在生成时会自动生成回收站相关的前后端代码和文件。</p><h3 id="如何在控制器或模型中获取当前登录的管理员或登录用户信息-7">如何在控制器或模型中获取当前登录的管理员或登录用户信息</h3><p>在FastAdmin所提供的基类<code>Frontend</code>、<code>Backend</code>、<code>Api</code>中都有提供获取当前管理员或登录用户的信息方法</p><p>在后台管理的控制器中可以通过<code>$this-&gt;auth-&gt;id</code>来获取<code>管理员ID</code>，<code>$this-&gt;auth-&gt;字段名</code>获取管理员的其它信息，如果需要在后台的<code>Model</code>中获取当前登录的<code>管理员ID</code>，可以通过两种方式获取：</p><div class="code-group">
  <ul class="nav nav-tabs" role="tablist">
    <li class="active"><a href="#code-group-item-1-0" role="tab" data-toggle="tab">第一种，使用Session来获取管理员信息</a></li><li class=""><a href="#code-group-item-1-1" role="tab" data-toggle="tab">第二种，使用单例方法来获取</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active in" id="code-group-item-1-0"><pre title="[第一种，使用Session来获取管理员信息]"><code class="language-php">\think\Session::get('admin');</code></pre></div><div class="tab-pane " id="code-group-item-1-1"><pre title="[第二种，使用单例方法来获取]"><code class="language-php">$auth = \app\admin\library\Auth::instance();</code></pre></div>
  </div>
</div><p>在前台或API的控制器中可以通过<code>$this-&gt;auth-&gt;id</code>来获取当前登录<code>会员ID</code>，<code>$this-&gt;auth-&gt;字段名</code>获取登录会员的其它信息，如果需要在前台的<code>Model</code>中获取当前登录的用户信息，可以通过以下的方式获取：</p><pre title=""><code class="language-php">//获取Auth对象
$auth = \app\common\library\Auth::instance();
//获取会员模型
$user = $auth-&gt;getUser();</code></pre><h3 id="安装后提示控制器不存在:E或控制器不存在:N-8">安装后提示控制器不存在:E或控制器不存在:N</h3><p>出现这种情况一般是由于Web服务器的<code>PATH_INFO</code>未配置正确，导致服务器接收到了错误的<code>PATH_INFO</code>值，请检查你的<code>PATH_INFO</code>并修复后再重试</p><h3 id="FastAdmin的数据库SQL文件在哪里-9">FastAdmin的数据库SQL文件在哪里</h3><p>FastAdmin在安装时会自动创建数据库和数据表,免除了你手动创建数据库和导入数据库的烦恼。<br>FastAdmin的数据库安装文件保存在 <a  href="https://www.fastadmin.net/outlink.html?url=https%3A%2F%2Fgitee.com%2Fkarson%2Ffastadmin%2Fraw%2Fmaster%2Fapplication%2Fadmin%2Fcommand%2FInstall%2Ffastadmin.sql"  target="_blank"  rel="nofollow">application/admin/command/Install/fastadmin.sql</a></p><h3 id="如何修改后台默认皮肤-10">如何修改后台默认皮肤</h3><p>为了进一步提升加载速度，后台默认启用了绿色主题的皮肤，如何修改其它皮肤呢？<br>从<code>1.3.0</code>版本开始，已经支持在后台配置自定义皮肤(仅对当前浏览器生效)，无需要修改配置文件。<br>从<code>1.2.0</code>版本开始，已经支持通过配置文件修改后台默认皮肤，可以直接修改<code>application/config.php</code>中的<code>adminskin</code>值来实现快速换肤功能，<code>adminskin</code>支持的值有</p><pre title=""><code>skin-blue/skin-black/skin-purple/skin-green/skin-red/skin-yellow
skin-blue-light/skin-black-light/skin-purple-light/skin-green-light/skin-red-light/skin-yellow-light
skin-black-blue/skin-black-purple/skin-black-green/skin-black-red/skin-black-yellow</code></pre><h3 id="为什么前台自己创建的控制器提示你没有权限访问-11">为什么前台自己创建的控制器提示你没有权限访问</h3><p>这是由于控制器的基类你肯定继承的是<code>Frontend</code>，<code>Frontend</code>基类有鉴权判断，有以下两种办法可以尝试</p><ol><li>添加控制器的属性<code>$noNeedRight=[&quot;*&quot;]</code>，表示无需再做鉴权</li><li>后台会员规则中添加相应的规则，再给对应的会员组赋予相应的权限即可</li></ol><h3 id="为什么后台给管理员所在组分配了权限，管理员仍然提示没有权限访问-12">为什么后台给管理员所在组分配了权限，管理员仍然提示没有权限访问</h3><p>如果是你自己添加的控制器，可以使用一键生成菜单命令(<code>php think menu -c 控制器名</code>)来生成菜单，如果你是手动添加的规则菜单，<strong>权限规则必须细化到控制器的方法才可以</strong>。</p><h3 id="php think install报不是内部或外部命令-13">php think install报不是内部或外部命令</h3><p>这是由于<code>php.exe</code>文件所在目录未加入到<code>PATH环境变量</code>导致的</p><p>找到<code>php.exe</code>文件所在的目录，将该目录加入到系统<code>PATH环境变量</code>中后，重启CMD即可解决</p><p>如果你找不到<code>php.exe</code>，可以参考<a  href="https://www.fastadmin.net/video/environment.html"  target="_blank">FastAdmin开发环境配置系列教程</a></p><h3 id="php think install报command not found-14">php think install报command not found</h3><p>这是由于在Linux环境下未找到php的脚本程序</p><p>有两种解决办法，首先尝试使用<code>which php</code>找到php所在的位置。</p><ol><li>找到php脚本程序所在的目录，加入到PATH环境变量中去，使用<code>export PATH=$PATH:php脚本程序所在目录</code></li><li>找到php脚本程序文件，使用<code>ln -s php脚本程序文件 /usr/bin/php</code></li></ol><h3 id="安装后只能访问网站首页，其它页均报404 page not found错误-15">安装后只能访问网站首页，其它页均报404 page not found错误</h3><p>这是由于你的服务器伪静态没有生效或错误导致的。</p><p>如果你使用<code>宝塔面板</code>，请直接在<code>宝塔面板后台</code>-&gt;<code>网站</code>-&gt;<code>伪静态</code> 中选择<code>ThinkPHP5</code>的伪静态规则即可。<br>如果你使用的是 <code>lnmp.org</code> 的一键安装<code>LNMP</code>环境，请查阅 <a href="https://www.fastadmin.net/outlink.html?url=https%3A%2F%2Flnmp.org%2Ffaq%2Flnmp-vhost-add-howto.html%23rewrite" target="_blank" rel="nofollow">https://lnmp.org/faq/lnmp-vhost-add-howto.html#rewrite</a> 的伪静态配置。<br>如果你使用的是<code>phpStudy</code>，建议参考视频安装教程中的伪静态配置：<a href="https://www.fastadmin.net/video/install.html" target="_blank" >https://www.fastadmin.net/video/install.html</a> </p><p>如果你是自行安装的<code>Nginx</code>，建议将虚拟主机的<code>root</code>绑定运行目录至<code>public</code>目录</p><p>例如：</p><pre title=""><code class="language-nginx">server {
        listen       80;
        server_name  www.fa.com *.fa.com;
        root   &quot;C:/phpstudy/WWW/fastadmin/public&quot;;
        location / {
            index  index.html index.htm index.php;
            #主要是这一段一定要确保存在
            if (!-e $request_filename) {
                rewrite  ^(.*)$  /index.php?s=/$1  last;
                break;
            }
            #结束
            #autoindex  on;
        }
        location ~ \.php(.*)$ {
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_split_path_info  ^((?U).+\.php)(/?.+)$;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  PATH_INFO  $fastcgi_path_info;
            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;
            include        fastcgi_params;
        }
}</code></pre><h3 id="安装后只能访问网站首页，其它页面均报no input file specified错误-16">安装后只能访问网站首页，其它页面均报no input file specified错误</h3><p>这是由于你的服务器伪静态没有生效或错误导致的，如果你使用宝塔面板，请直接在<code>宝塔面板后台</code>-&gt;<code>网站</code>-&gt;<code>伪静态</code> 中选择<code>ThinkPHP5</code>的伪静态规则即可。</p><p>这种情况一般在<code>Apache</code>下伪静态不工作的情况下出现，<br>首先确保已经启用<code>Apache</code>的伪静态，确保目录已经配置好权限，如下面的<code>Directory</code>配置</p><pre title=""><code class="language-apache">&lt;VirtualHost *:80&gt;
    DocumentRoot &quot;/Project/fastadmin/public&quot;
    ServerName fa.com 
    ServerAlias fa.com *.fa.com
    &lt;Directory &quot;/Project/fastadmin&quot;&gt;
        AllowOverride All
        Options Indexes FollowSymLinks
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;</code></pre><p>其次伪静态规则在<code>Apache fastcgi</code>模式下会导致<code>No input file specified.</code>，未指定输入文件。<br>请修改<code>public</code>目录下的<code>.htaccess</code>文件</p><p>默认的</p><pre title=""><code class="language-apache">RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]</code></pre><p>修改成</p><pre title=""><code class="language-apache">RewriteRule ^(.*)$ index.php [L,E=PATH_INFO:$1]</code></pre><h3 id="composer install时无法下载package-17">composer install时无法下载package</h3><p>这是由于<code>composer</code>默认配置是境外的源，如遇网络故障则会导致无法下载</p><p>推荐使用国内的镜像源，有以下两种启用方法</p><div class="code-group">
  <ul class="nav nav-tabs" role="tablist">
    <li class="active"><a href="#code-group-item-2-0" role="tab" data-toggle="tab">方法一：修改 composer 的全局配置文件(推荐)</a></li><li class=""><a href="#code-group-item-2-1" role="tab" data-toggle="tab">方法二：修改当前项目的 composer.json 配置文件</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active in" id="code-group-item-2-0"><pre title="[方法一：修改 composer 的全局配置文件(推荐)]"><code class="language-js">// 打开命令行窗口并执行如下命令：
composer config -g repos.packagist composer https://mirrors.tencent.com/composer/</code></pre></div><div class="tab-pane " id="code-group-item-2-1"><pre title="[方法二：修改当前项目的 composer.json 配置文件]"><code class="language-js">// 打开命令行窗口，进入你的项目的根目录（也就是 composer.json 文件所在目录），执行如下命令：
composer config repos.packagist composer https://mirrors.tencent.com/composer/</code></pre></div>
  </div>
</div><h3 id="如何修改或禁用左侧菜单栏的角标-18">如何修改或禁用左侧菜单栏的角标</h3><p>FastAdmin后台左侧菜单栏有彩色的小角标，这一般用于通知和提醒操作，在后台开发时是非常方便的一个小功能，如何修改和禁用它呢？<br>找到<code>/application/admin/controller/Index.php</code>中的index方法，其中有一段</p><pre title=""><code class="language-php">$menulist = $this-&gt;auth-&gt;getSidebar([
    'dashboard'  =&gt; 'hot',
    'auth'       =&gt; ['new', 'red', 'badge'],
    'auth/admin' =&gt; 12,
    'auth/rule'  =&gt; 4,
    'general'    =&gt; ['18', 'purple'],
]);</code></pre><p>数组的键名是对应的左侧菜单栏的相对链接<br>数组的键值是需要显示的文字或数字，可以传字符串或数组</p><div class="custom-block custom-block github-alert note"><p class="custom-block-title">说明</p><p><ol><li>如果是字符串，则角标的颜色是按照<code>'red', 'green', 'yellow', 'blue', 'teal', 'orange', 'purple'</code>的方式进行循环的。</li><li>如果是数组，这三个值分别表示：[显示的文字, 颜色，展现方式(<code>badge</code>或<code>label</code>)]</li></ol></p></div><p>如果需要删除这个小角标，则可以直接到数组置为空即可</p><p>在JS端同样可以进行相应的操作，在JS中对应需要刷新角标的地方使用以下方法即可添加或删除</p><div class="code-group">
  <ul class="nav nav-tabs" role="tablist">
    <li class="active"><a href="#code-group-item-3-0" role="tab" data-toggle="tab">添加小角标</a></li><li class=""><a href="#code-group-item-3-1" role="tab" data-toggle="tab">移除小角标</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active in" id="code-group-item-3-0"><pre title="[添加小角标]"><code class="language-js">top.window.Backend.api.sidebar({
    'auth/admin':44
});</code></pre></div><div class="tab-pane " id="code-group-item-3-1"><pre title="[移除小角标]"><code class="language-js">top.window.Backend.api.sidebar({
    'auth/admin':0
});</code></pre></div>
  </div>
</div><h3 id="后台上传文件时提示HTTP Error.(code:-200)错误-19">后台上传文件时提示HTTP Error.(code:-200)错误</h3><p>首先可以尝试下清空浏览器缓存后再刷新重试<br>其次可以使用谷歌浏览器的开发者工具，按F12，切换到<code>Network</code>，看具体的上传文件时的错误信息。</p><h3 id="在Windows下如何压缩打包JS和CSS-20">在Windows下如何压缩打包JS和CSS</h3><p>在FastAdmin中压缩打包JS和CSS文件需要NodeJS的支持<br>在Windows下需要手动配置Node的可执行文件,请修改<code>application/admin/command/Min.php</code>中<code>$nodeExec</code>的值<br>如你的Node可执行文件是<code>C:/Program Files/nodejs/node.exe</code>，则请配置<code>$nodeExec = '&quot;C:/Program Files/nodejs/node.exe&quot;'</code>;</p><h3 id="提示你所浏览的页面暂时无法访问-21">提示你所浏览的页面暂时无法访问</h3><p>如果我们在FastAdmin开发过程中遇到此错误，说明我们<code>application/config.php</code>中的<code>app_debug</code>是关闭的，必须开启<code>app_debug</code>为<code>true</code>才可以显示出详细的错误信息。如果开启<code>app_debug</code>仍然显示不出详细错误，请确保<code>php.ini</code>中的<code>display_error</code>为开启状态。</p><h3 id="提示未知的数据格式或网络错误-22">提示未知的数据格式或网络错误</h3><p>很多时候都有可能遇到提示<code>未知的数据格式</code>或<code>网络错误</code>这个提示，产生这个错误的原因一般来说都是服务端报错，导致返回的数据不是JSON格式或直接未返回，如下图</p><p><img  src="https://cdn.fastadmin.net/uploads/2017/201706/02/0f650de53f0ee93ddfd658f731027d43"  alt=""  title=""></p><p>准备工作：首先确保你的FastAdmin开启了调试模式<code>application/config.php</code>中的<code>app_debug</code>置为<code>true</code><br>两种定位错误的方法：</p><ol><li>使用Chrome浏览器，打开开发者工具，选中<code>Network(网络)</code>选项卡,刷新一下页面或重新请求一次，定位到我们请求的URL，点击然后在<code>Preview</code>即可看到错误信息</li><li>直接查看<code>runtime/log</code>目录下的错误日志</li></ol><p>修复错误后再重试即可</p><p>FastAdmin建议运行在<code>PHP7.2</code>及以上版本，因此如果提示网络错误请检查你的PHP是否低于该版本</p><h3 id="如何将静态资源(/assets/目录下文件)采用CDN方式部署？-23">如何将静态资源(/assets/目录下文件)采用CDN方式部署？</h3><div class="custom-block github-alert tip"><p class="custom-block-title">温馨提示</p><p>如果你只需要将上传的文件上传至<a  href="https://www.fastadmin.net/store/upyun.html"  target="_blank">又拍云</a>、<a  href="https://www.fastadmin.net/store/qiniu.html"  target="_blank">七牛云</a>或<a  href="https://www.fastadmin.net/store/alioss.html"  target="_blank">阿里OSS</a>，请在<code>插件管理</code>中下载对应第三方云存储的插件并配置好即可，无需下方的步骤。</p></div><p>FastAdmin可以将框架静态的资源部署到云存储或CDN，可大大的加快网站的访问，默认FastAdmin框架的静态资源是不采用CDN部署的，如果需要启用，需要修改以下两个文件的配置</p><ol><li>修改<code>application/extra/site.php</code>中<code>cdnurl</code>的值为你CDN的地址</li><li>修改<code>application/config.php</code>中<code>__CDN__</code>的值为你CDN的地址</li></ol><p>然后请将你的静态资源<code>public/assets</code>文件夹同步至你的CDN。</p><p><font  color="red">如果采用了静态资源CDN部署，在后台<code>插件管理</code>中对插件执行安装、禁用、启用、卸载后都需要将<code>public/assets/addons/</code>目录和<code>public/assets/js/addons.js</code>文件刷新缓存或同步更新到CDN。</font></p><h3 id="为何后台管理总是一登录或每隔几秒或几分钟就自动退出？-24">为何后台管理总是一登录或每隔几秒或几分钟就自动退出？</h3><p>为了后台安全，新版本默认开启了后台IP变动检测，如果你需要关闭此功能，可以修改<code>application/config.php</code>，将<code>loginip_check</code>置为<code>false</code>即可。</p><div class="custom-block github-alert tip"><p class="custom-block-title">温馨提示</p><p>如果你使用了CDN、分布式部署或负载均衡，也有可能导致获取IP地址不正确，从而导致一登录就自动退出，请参考<a href="https://doc.fastadmin.net/doc/faq.html#toc-50" target="_blank" >https://doc.fastadmin.net/doc/faq.html#toc-50</a></p></div><h3 id="为何页面头部总是输出一个多余的●或?-25">为何页面头部总是输出一个多余的●或?</h3><p>一般出现这种情况都是由于你使用了<code>Windows</code>自带编辑器编辑了某个配置文件或模板，导致文件本身的编码变成了<code>utf8-bom</code>格式，这时你需要排查你的项目的所有文件。如果你使用<code>PHPStorm</code>进行开发，可以在项目目录根路径上点击右键，点击<code>Remove BOM</code>来移除<code>bom</code>头，将文件编码变为<code>utf8</code>(新版本PHPStorm请选中文件夹后，点击菜单中的<code>文件-&gt;文件属性-&gt;移除BOM</code>进行移除)。</p><h3 id="后台管理默认首页如何修改？-26">后台管理默认首页如何修改？</h3><p>后台管理后台默认是<code>控制台</code>首页，如需修改，请在后台-&gt;<code>常规管理</code>-&gt;<code>系统配置</code>中，将<code>后台固定页</code>修改为你的控制器方法的链接即可，这里注意使用相对链接即可。</p><h3 id="安装应用插件时报无法打开zip文件、未知的数据格式(code:0)、插件下载失败、你所浏览的页面暂时无法访问等错误时如何排查？-27">安装应用插件时报无法打开zip文件、未知的数据格式(code:0)、插件下载失败、你所浏览的页面暂时无法访问等错误时如何排查？</h3><ol><li>首先在后台-&gt;<code>插件管理</code>-&gt;<code>会员信息</code>是否登录已购买应用插件的账号。</li><li>其次检查服务器，在线安装和离线安装均只支持中国内地服务器安装，其它地区无法进行在线安装或离线安装。</li><li>检查下PHP版本，目前最新版本只支持<code>7.4</code>（FastAdmin 1.3.4+），请检查你使用的PHP版本。</li><li>请检查你服务器的网络能否正常请求外网(公网)，无法请求公网环境是无法安装应用插件。</li><li>如果有开启了宝塔的防火墙请先尝试关闭后安装，建议本地安装后再迁移到生产服务器。</li><li>检查站点下目录<code>runtime</code>是否有读写权限。</li><li>如果排除服务器问题，请开启调试后重试看具体错误原因，开启调试的方法：<a href="https://ask.fastadmin.net/question/985.html" target="_blank" >https://ask.fastadmin.net/question/985.html</a></li><li>请确定是否以超级管理员的身份登录的后台。</li></ol><h3 id="表单提交保存数据时提示SQLSTATE[22001]: String data, right truncated: 1406 Data too long for column 'content' at row 1？-28">表单提交保存数据时提示SQLSTATE[22001]: String data, right truncated: 1406 Data too long for column 'content' at row 1？</h3><p>这是由于系统在检测到POST提交时会记录提交的参数信息，如果提交的POST数据过大，会导致日志表的<code>content</code>字段溢出，此时我们需要修改<code>fa_admin_log</code>表的<code>content</code>字段，将字段类型修改为<code>longtext</code>类型即可。</p><h3 id="后台表格列表选择导出到Excel并打开后无法显示图片该如何操作？-29">后台表格列表选择导出到Excel并打开后无法显示图片该如何操作？</h3><p>这是由于上传配置中的<code>cdnurl</code>为空，导致导出的图片没有截图域名前缀，需要手动修改<code>application/extra/upload.php</code>中的<code>cdnurl</code>值，将<code>cdnurl</code>的值修改为你的站点地址即可，例如：<code>https://www.example.com</code>，注意不能以<code>/</code>结尾。</p><h3 id="前台提交的富文本内容被过滤，首行空格丢失该如何操作-30">前台提交的富文本内容被过滤，首行空格丢失该如何操作</h3><p>有些时候我们在前台提交的富文本内容被过滤了，比如富文本首行的缩进丢失，这是由于FastAdmin前台是有开启全局过滤，你可以自行修改<code>application/common/controller/Frontend.php</code>移除<code>trim</code>过滤限制，特别注意<code>strip_tags,htmlspecialchars</code>不建议移除，移除后会导致跨站安全问题。</p><h3 id="后台插件管理安装插件时提示插件已经存在?-31">后台插件管理安装插件时提示插件已经存在?</h3><p>这种情况常出现在安装后又卸载插件，而卸载插件时由于插件目录中有文件被打开或被其它软件占用，导致卸载插件时目录无法清除干净，此时再次安装插件时就会出现该情况，请尝试做好备份，手动清除<code>addons/插件标识</code>文件夹后重试，插件标识可以从插件URL中查询到，如知识付费问答社区：<a href="https://www.fastadmin.net/store/ask.html" target="_blank" >https://www.fastadmin.net/store/ask.html</a> 它的插件标识则是<code>ask</code>。</p><h3 id="如何调整插件伪静态的优先级？-32">如何调整插件伪静态的优先级？</h3><p>在FastAdmin中插件中配置的伪静态优先级默认是按照字母来排序的，如果我们需要修改插件伪静态的优先级，可以手动配置<code>application/extra/addons.php</code>，修改其中的<code>priority</code>，添加应用插件标识，放在前面则优先匹配，如</p><pre title=""><code>'priority' =&gt; [&quot;third&quot;, &quot;cms&quot;, &quot;ask&quot;],</code></pre><p>这里表示优先配置<code>third</code>，然后才是<code>cms</code>和<code>ask</code>。<br>最后在后台插件管理右上角清除插件缓存即可。</p><h3 id="在后台系统配置中配置了cdn地址而导致后台管理无法登录时该如何还原？-33">在后台系统配置中配置了cdn地址而导致后台管理无法登录时该如何还原？</h3><p>后台<code>常规管理</code>-&gt;<code>系统配置</code>的<code>cdn地址</code>仅限用于静态资源采用CDN部署时才需要配置，如果静态资源未部署CDN，而此时在后台系统配置中配置了<code>cdn地址</code>会导致后台样式丢失，且后台无法登录，此时我们需要手动修改<code>application/extra/site.php</code>中的<code>cdnurl</code>，将它的值修改为空即可。</p><div class="custom-block github-alert tip"><p class="custom-block-title">温馨提示</p><p>FastAdmin 从1.3.x版本开始已经在后台移除该配置。</p></div><h3 id="打开页面报sql_mode=only_full_group_by错误时该怎么办？-34">打开页面报sql_mode=only_full_group_by错误时该怎么办？</h3><p>这是由于你的Mysql配置中设置了<code>only_full_group_by</code>导致的错误，需要你修改你的<code>Mysql</code>配置，首先需要找到你的Mysql的<code>my.cnf</code>，找到其中的<code>mysqld</code>，修改<code>sql_mode</code>，移除<code>ONLY_FULL_GROUP_BY</code>，如</p><pre title=""><code class="language-ini">[mysqld]  
sql_mode = &quot;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&quot;</code></pre><p>然后重启Mysql服务即可。</p><h3 id="为何后台常规管理系统配置中没有添加配置项的功能？-35">为何后台常规管理系统配置中没有添加配置项的功能？</h3><p>从1.3.0+版本开始，后台系统配置中添加配置项的功能只在开发环境才可使用，如需添加配置，需要开启调试模式后，再刷新页面即可。</p><h3 id="为何后台表格拖拽排序配置后仍然为灰色，无法进行拖拽排序？-36">为何后台表格拖拽排序配置后仍然为灰色，无法进行拖拽排序？</h3><p>如果启用固定列，此时不支持拖拽排序，所以会为灰色，如需启用拖拽排序，只能禁用固定列，找到页面对应的JS，移除代码中的<code>fixedColumns：true</code>即可。</p><h3 id="为何多文件(多图片)预览时无法正常显示？-37">为何多文件(多图片)预览时无法正常显示？</h3><p>目前多文件(多图片)中的文件地址暂不支持存在<code>,</code>，会导致图片错误，请参考：<a href="https://doc.fastadmin.net/doc/177.html#toc-5" target="_blank" >https://doc.fastadmin.net/doc/177.html#toc-5</a> 温馨提示中的说明。</p><h3 id="提示“不允许上传的文件类型”如何处理？-38">提示“不允许上传的文件类型”如何处理？</h3><p>打开 <code>application/extra/upload.php</code>，修改<code>mimetype</code>，加入需要上传类型的文件后缀。</p><h3 id="后台登录时验证码不显示？-39">后台登录时验证码不显示？</h3><p>首先请检查：<code>application/config.php</code>是否设置<code>login_captcha</code>，为<code>true</code>时才会启用验证码功能。<br>其次请参考：<a href="https://ask.fastadmin.net/question/985.html" target="_blank" >https://ask.fastadmin.net/question/985.html</a> 排查下图片是否有报错信息，如果状态码为<code>500</code>或<code>404</code>，请开启调试后查看具体错误原因。如果接口状态码为<code>200</code>，说明图片接口正常，请检查下是否在<code>Windows</code>下使用<font  color="blue"><strong>自带记事本</strong></font>编辑了代码文件(或修改配置文件)，导致编辑的文件存在<code>utf8 bom</code>头，请移除<code>utf8 bom</code>头，使用<code>utf8</code>编码后重试。<br>请检查PHP环境<code>GD</code>库是否正确安装。<br>如果以上方法试了都不行，建议开启调试模式后调试下<code>vendor/topthink/think-captcha/src/Captcha.php</code>中的<code>entry</code>方法排查具体错误原因。</p><h3 id="管理员登录时提示请于1天后再尝试登录？-40">管理员登录时提示请于1天后再尝试登录？</h3><p>这是由于<code>FastAdmin</code>框架默认开启了登录失败重试次数限制，当失败次数超过<code>10</code>次时，需要1天后才可以重新登录，你可以手动登录数据库修改数据库表<code>fa_admin</code>中对应管理员的<code>loginfailure</code>为<code>0</code>，然后重试登录即可。</p><h3 id="上传文件时提示未上传文件或超出服务器上传限制？-41">上传文件时提示未上传文件或超出服务器上传限制？</h3><p>这种情况一般出现在本地上传时出现，通常情况下是由于上传的文件超出了服务器配置的限制，导致服务端无法正常获取到数据，请参考问题进行修改服务器配置：<a href="https://ask.fastadmin.net/question/27680.html" target="_blank" >https://ask.fastadmin.net/question/27680.html</a></p><h3 id="如何关闭前台会员中心？-42">如何关闭前台会员中心？</h3><p>打开 <code>application/config.php</code>，找到底部<code>fastadmin</code>配置，修改<code>usercenter</code>值为<code>false</code>即可。</p><h3 id="如何开启前台会员中心手机注册验证码？-43">如何开启前台会员中心手机注册验证码？</h3><p>首先在插件市场安装一款<a  href="https://www.fastadmin.net/store.html?category=18&pay=all&order=default"  target="_blank">短信插件</a>并配置相关的参数，然后打开 <code>application/config.php</code>，找到底部<code>fastadmin</code>配置，修改<code>user_register_captcha</code>值为<code>mobile</code>即可。</p><h3 id="如何开启前台会员中心邮箱注册验证码？-44">如何开启前台会员中心邮箱注册验证码？</h3><p>打开 <code>application/config.php</code>，找到底部<code>fastadmin</code>配置，修改<code>user_register_captcha</code>值为<code>email</code>即可。</p><h3 id="为什么页面始终有响应Cache-Control: no-store, no-cache, must-revalidate？-45">为什么页面始终有响应Cache-Control: no-store, no-cache, must-revalidate？</h3><p>这是由于你在页面中使用了<code>session</code>，或视图模板中有调用<code>{:token()}</code>输出<code>token</code>(此时也会使用到<code>session</code>)，因使用了<code>session</code>的页面，会自动添加响应头<code>Cache-Control: no-store, no-cache, must-revalidate</code>。</p><h3 id="后台添加或编辑时提示Forbidden错误提示？-46">后台添加或编辑时提示Forbidden错误提示？</h3><p>首先请检查<code>runtime/log</code>中的日志信息，检查是否有错误信息产生，如果有错误信息请根据错误信息进行处理，如果没有错误，请检查是否使用了宝塔面板，请检查是否宝塔面板中的防火墙进行了拦截。</p><h3 id="为什么使用 join 后再使用排序操作出现 SQLSTATE 1267 Illegal mix of collations 问题？-47">为什么使用 join 后再使用排序操作出现 SQLSTATE 1267 Illegal mix of collations 问题？</h3><p>这是因为数据表的字符集不一致导致的，请将数据表统一一下，比如都使用 <code>utf8mb4_general_ci</code></p><h3 id="FastAdmin1.3.4和1.3.5版本中Bootstrap-Select组件异常如何处理？-48">FastAdmin1.3.4和1.3.5版本中Bootstrap-Select组件异常如何处理？</h3><p>这是由于<code>FastAdmin</code>框架中引入了新版本<code>Bootstrap-Select</code>组件导致冲突，目前建议你做好备份后，下载<a href="https://cdn.fastadmin.net/uploads/2023/03/24/d9988d44627f5407ab4d3027b9b19b87.zip" target="_blank" >https://cdn.fastadmin.net/uploads/2023/03/24/d9988d44627f5407ab4d3027b9b19b87.zip</a> </p><p>解压后将其中的<code>public</code>文件夹覆盖到站点目录进行合并，然后清浏览器缓存即可。</p><h3 id="配置使用了https协议但图片地址和上传地址是http协议？-49">配置使用了https协议但图片地址和上传地址是http协议？</h3><p>首先如果有安装使用云存储插件，请检查云存储插件中配置的<code>CDN地址</code>和<code>上传接口地址</code>是否使用了<code>http</code><br>其次如果我们使用了CDN，也有可能导致该问题发生，此时建议你检查你使用的CDN的配置在回源时是否支持<code>HTTP_X_FORWARDED_PROTO</code>，如果支持请检查该值是否为<code>https</code>，如果不支持<code>HTTP_X_FORWARDED_PROTO</code>，请检查你的CDN是否支持自定义回源参数，如果支持自定义回源参数，请自定义一个回源参数，然后修改<code>application/config.php</code>，添加一项<code>https_agent_name</code>配置，<code>https_agent_name</code>的值为你自定义回源参数即可。</p><h3 id="服务器使用了负载均衡或CDN后造成获取客户端IP为内网IP以及生成URL链接不正确时该如何处理？-50">服务器使用了负载均衡或CDN后造成获取客户端IP为内网IP以及生成URL链接不正确时该如何处理？</h3><p>如果服务器使用了负载均衡或CDN后造成<code>获取客户端IP为内网IP</code>以及<code>生成URL链接不正确</code>时可按以下方式修改配置。</p><p><strong>问题1：获取客户端IP为内网IP</strong><br>因为在ThinkPHP5框架中获取客户端IP是通过<code>REMOTE_ADDR</code>参数来获取的，如果此时我们使用了负载均衡或CDN后会造成客户端IP为负载均衡或CDN服务器的IP地址，此时我们可以咨询我们使用的云服务商或参考云服务商提供的相关文档，获取负载均衡或CDN传递真实IP的参数名，然后修改<code>application/config.php</code>中的<code>http_agent_ip</code>值即可。</p><p><strong>问题2：生成的URL链接不正确</strong><br>因为ThinkPHP5框架中使用<code>url</code>函数生成URL路径时，优先使用<code>HTTPS/REQUEST_SCHEME/SERVER_PORT/HTTP_X_FORWARDED_PROTO</code>来判断是否是<code>SSL</code>请求，从而生成URL地址。<br>如果服务器使用了负载均衡或CDN后，由于服务器无法获取到这几个参数判断，从而导致生成URL地址错误，主要表现在生成的URL地址本应该是<code>https://</code>开头，但却生成了<code>http://</code>开头。</p><p>解决办法分两种：<br>一种是需要修改<code>application/config.php</code>，添加一个<code>is_https</code>的参数，值设定为<code>true</code>即可，这种解决方案会导致不管是否是<code>SSL</code>请求，都会强制生成<code>https://</code>开头的URL。<br>另一种就是添加转发参数，通常情况下负载均衡或CDN都会有转发或回源参数的配置，添加以下转发(回源)参数，让服务器识别到<code>SSL</code>请求即可。</p><table><thead><tr><th>参数名</th><th>参数值</th></tr></thead><tbody><tr><td>HTTP_X_FORWARDED_PROTO</td><td>https</td></tr></tbody></table><h3 id="如何自定义404页面显示模板？-51">如何自定义404页面显示模板？</h3><p>在FastAdmin框架中如果使用了<code>throw new \think\exception\HttpException(404, '页面不存在');</code>或<code>abort(404,'页面不存在');</code>抛出了<code>404</code>错误，默认情况下会提示<code>你所浏览的页面暂时无法访问</code>，如果我们希望自定义404的错误页面，可以修改<code>application/config.php</code>配置文件，找到<code>http_exception_template </code>的配置文件，如果不存在，需要手动添加配置项，配置如下：</p><pre title=""><code>'http_exception_template'    =&gt;  [
    // 定义404错误的重定向页面地址
    404 =&gt;  APP_PATH . 'common/view/tpl/404.tpl',
],</code></pre><p>然后在对应的<code>application/common/view/tpl/</code>目录下创建<code>404.tpl</code>模板即可。</p><div class="custom-block github-alert tip"><p class="custom-block-title">温馨提示</p><p>1、该配置仅在生产环境下生效，如果开启了调试模式仍然会提示详细的错误信息。<br>2、默认修改<code>application/config.php</code>会对<code>application</code>目录下的所有模块起作用，如<code>index</code>、<code>admin</code>、<code>api</code>，如果希望仅对<code>index</code>模块起作用，可以在<code>application/index</code>目录下创建一个<code>config.php</code>配置并做以上的配置。</p></div><h3 id="如何将插件管理配置的菜单添加到左侧菜单导航？-52">如何将插件管理配置的菜单添加到左侧菜单导航？</h3><p>默认情况下插件管理配置的菜单都是需要通过<code>插件管理</code>-&gt;<code>配置</code>进行管理，如果需要在左侧菜单中添加相应的快捷链接，可以通过<code>权限管理</code>-&gt;<code>菜单规则</code>-&gt;<code>添加</code>，添加中<code>规则</code>使用<code>addon/config/name/插件标识</code>的菜单即可。</p><h3 id="后台单独绑定域名后导致插件系统前台地址报错？-53">后台单独绑定域名后导致插件系统前台地址报错？</h3><p>默认前后台使用同一个域名时前台插件系统不会报错，如果后台单独绑定了域名，导致插件前台URL地址拼接错误，此时框架无法得知你前台插件域名主站的域名，此时需要手动修改<code>application/admin/config.php</code>，添加上如下配置：</p><pre title=""><code>'view_replace_str'       =&gt; [
        '__PUBLIC__' =&gt; 'https://www.example.com',
    ],</code></pre><p>其中<code>https://www.example.com</code>为你主站的站点地址。</p><h3 id="搜索引擎收录带有/index.php的页面时该如何处理？-54">搜索引擎收录带有/index.php的页面时该如何处理？</h3><p>通常情况下我们请求的页面都是不带<code>/index.php</code>，如果希望只保留不带<code>/index.php</code>的页面，可以通过修改<code>application/common/behavior/Common.php</code>中的<code>moduleInit</code>方法，在该方法内开头处添加如下代码即可</p><pre title=""><code>if (stripos($request-&gt;url(), &quot;/index.php&quot;) === 0) {
    $url = str_replace(&quot;/index.php&quot;, &quot;&quot;, $request-&gt;url());
    $url = $url ?: &quot;/&quot;;
    header(&quot;HTTP/1.1 301 Moved Permanently&quot;);
    header(&quot;Location: &quot; . $url);
    exit;
}</code></pre><h3 id="微信PC端内打开网页或小程序报错？-55">微信PC端内打开网页或小程序报错？</h3><p>如果在微信PC端内打开调试模式后报<code>Undefined offset: 1 in /www/wwwroot/www.example.com/application/common/view/tpl/think_exception.tpl</code>或<code>Undefined offset: 1 in /www/wwwroot/www.example.com/thinkphp/library/think/Lang.php</code>，可参考以下方法进行修复：<br><code>application/common/view/tpl/think_exception.tpl</code>大概第<code>22</code>行</p><pre title=""><code>$langSet     = strtolower($matches[1]);</code></pre><p>修改为</p><pre title=""><code>$langSet     = strtolower($matches[1] ?? '');</code></pre><p><code>thinkphp/library/think/Lang.php</code>大概第<code>204</code>行</p><pre title=""><code>$langSet     = strtolower($matches[1]);</code></pre><p>修改为：</p><pre title=""><code>$langSet     = strtolower($matches[1] ?? '');</code></pre><p>使用旧版本FastAdmin的如果不需要多语言的可以关闭多语言<code>application/config.php</code>修改为<code>'lang_switch_on' =&gt; false</code></p><p>这是由于新版本微信电脑端<code>HTTP_ACCEPT_LANGUAGE</code>获取为<code>*</code>而导致该错误。<br>参考：<br><a href="https://www.fastadmin.net/outlink.html?url=https%3A%2F%2Fgitee.com%2Fkarson%2Ffastadmin%2Fblob%2F1.x%2Fapplication%2Fcommon%2Fview%2Ftpl%2Fthink_exception.tpl" target="_blank" rel="nofollow">https://gitee.com/karson/fastadmin/blob/1.x/application/common/view/tpl/think_exception.tpl</a></p><h3 id="为什么应用插件的菜单手动修改后再升级应用插件后菜单被还原了？-56">为什么应用插件的菜单手动修改后再升级应用插件后菜单被还原了？</h3><p>这是由于FastAdmin应用插件系统菜单升级功能导致，如果不希望菜单升级覆盖原有的菜单，可通过修改<code>application/common/library/Menu.php</code>中的<code>menuUpdate</code>方法，将大概第<code>196</code>行的</p><pre title=""><code>$menu = $oldMenu[$data['name']];</code></pre><p>修改为</p><pre title=""><code>$menu = $oldMenu[$data['name']];
unset($menu['title']);</code></pre><p>即可。</p><div class="custom-block github-alert caution"><p class="custom-block-title">需谨慎</p><p><font  color="red">温馨提示：这种修改将导致无法和最新版本应用插件的菜单标题同步。</font></p></div><h3 id="为什么图片启用防盗链后，后台图片无法加载？-57">为什么图片启用防盗链后，后台图片无法加载？</h3><p>这是由于FastAdmin框架后台设定了<code>referer</code>为<code>never</code>，也就是不发送携带<code>referer</code>参数，你可以自行修改<code>application/admin/view/common/meta.html</code>，找到大概第<code>5</code>行的</p><pre title=""><code>&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;</code></pre><p>移除该行即可，但通常不建议移除，这样会导致我们的列表中的图片携带有<code>referer</code>信息，如果一定要移除，建议配合浏览器安全策略插件：<a href="https://www.fastadmin.net/store/csp.html" target="_blank" >https://www.fastadmin.net/store/csp.html</a> 来限制只加载指定域名下图片的加载。</p><h3 id="修改插件配置或右上角清缓存提示failed to open stream: Permission denied该如何处理？-58">修改插件配置或右上角清缓存提示failed to open stream: Permission denied该如何处理？</h3><p>如果我们在插件管理<code>修改配置</code>或<code>右上角清缓存时</code>提示<code>file_put_contents(/www/wwwroot/www.example.com/xxx/xxx.php): failed to open stream: Permission denied</code>，请检查对应的文件是否有写权限，修改配置或清缓存需要更新该文件，开发或配置阶段建议给对应文件添加相应的写权限，正式上线后建议移除写权限。</p><h3 id="后台登录时一直提交令牌数据无效该如何排查？-59">后台登录时一直提交令牌数据无效该如何排查？</h3><p>请参考以下几点进行排查：<br>1、停留在登录页时间过长<br>2、开启了新的登录页，原登录页<code>token</code>会失效<br>3、当前登录页有其它请求导致刷新了<code>token</code>，建议使用网页开发者工具进行排查<br>4、检查服务器磁盘是否有剩余空间，磁盘空间满也会导致该错误<br>5、检查是否使用了分布式部署，在分布式部署时务必保证将<code>Session</code>存储至数据库或<code>Redis</code></p>
    <div class="date text-muted" style="margin-top:10px;">文档最后更新时间：2024-09-25 10:02:11</div>
    <div class="copyrights text-muted" style="margin-top:10px;">著作权归应用插件开发者所有，未经许可，禁止转载、复制此文档的任何内容。</div>

        <div class="docs-links">
        <!--@formatter:off-->
                    <span>← <a href="https://doc.fastadmin.net/doc/171.html" data-id="171">服务器安全</a></span>
                        <span style="float:right"><a href="https://doc.fastadmin.net/doc/contributing.html" data-id="159">参与开源生态贡献</a> →</span>
                    <!--@formatter:on-->
    </div>
    
    